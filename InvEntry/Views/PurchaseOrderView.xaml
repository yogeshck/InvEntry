<UserControl x:Class="InvEntry.Views.PurchaseOrderView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
             xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
             xmlns:local="clr-namespace:InvEntry.Views"
             xmlns:sys="clr-namespace:System;assembly=mscorlib"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:dxdo="http://schemas.devexpress.com/winfx/2008/xaml/docking"
             xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
             xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars"
             xmlns:dxlc="http://schemas.devexpress.com/winfx/2008/xaml/layoutcontrol"
             xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm" 
             xmlns:viewmodels="clr-namespace:InvEntry.ViewModels"
             xmlns:ext="clr-namespace:InvEntry.Extension"
             xmlns:behavior="clr-namespace:InvEntry.Behavior"
             d:DataContext="{d:DesignInstance Type=viewmodels:PurchaseOrderViewModel}"
             DataContext="{ext:DISource Type=viewmodels:PurchaseOrderViewModel}"
             mc:Ignorable="d" 
             d:DesignHeight="450" HorizontalAlignment="Left" Width="1471">
             <!-- Height="600" Width="900"> -->

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Customer Details -->
        <GroupBox Header="Customer Details" Grid.Row="0" Margin="0,0,0,10">
            <StackPanel Orientation="Vertical" Margin="10">
                <dxe:TextEdit Width="300" 
                              EditValue="{Binding CustomerName, Mode=TwoWay}" 
                              Label="Customer Name:"/>
                <dxe:TextEdit Width="200" 
                              EditValue="{Binding ContactNo, Mode=TwoWay}" 
                              Label="Contact No:"/>
                <dxe:MemoEdit Width="400" Height="60" 
                              EditValue="{Binding Address, Mode=TwoWay}" 
                              Label="Address:"/>
                <StackPanel Orientation="Horizontal">
                    <dxe:ComboBoxEdit Width="150" 
                                      ItemsSource="{Binding IDProofTypes}" 
                                      EditValue="{Binding IDProofType, Mode=TwoWay}" 
                                      Label="ID Proof Type:"/>
                    <dxe:TextEdit Width="200" 
                                  EditValue="{Binding IDProofNumber, Mode=TwoWay}" 
                                  Label="ID Proof No:"/>
                </StackPanel>
            </StackPanel>
        </GroupBox>

        <!-- Purchase Header -->
        <GroupBox Header="Purchase Order Info" Grid.Row="1" Margin="0,0,0,10">
            <StackPanel Orientation="Horizontal" Margin="10">
                <dxe:DateEdit Width="150" 
                              EditValue="{Binding PurchaseDate, Mode=TwoWay}" 
                              Label="Date:"/>
                <dxe:TextEdit Width="150" 
                              EditValue="{Binding OrderNo}" 
                              Label="Order No:" IsReadOnly="True"/>
                <dxe:MemoEdit Width="300" Height="40" 
                              EditValue="{Binding Remarks, Mode=TwoWay}" 
                              Label="Remarks:"/>
            </StackPanel>
        </GroupBox>

        <!-- Items Grid -->
        <dxg:GridControl Grid.Row="2" 
                         ItemsSource="{Binding PurchaseItems}" 
                         AutoGenerateColumns="None"
                         SelectedItem="{Binding SelectedItem, Mode=TwoWay}">
            <dxg:GridControl.View>
                <dxg:TableView NewItemRowPosition="Top"
                               ShowGroupPanel="False"
                               AllowEditing="True"
                               EditFormShowMode="Inline"
                               AllowPerPixelScrolling="True"/>
            </dxg:GridControl.View>

            <dxg:GridColumn FieldName="MetalType" Header="Metal Type">
                <dxg:GridColumn.EditSettings>
                    <dxe:ComboBoxEditSettings ItemsSource="{Binding MetalTypes}" />
                </dxg:GridColumn.EditSettings>
            </dxg:GridColumn>

            <dxg:GridColumn FieldName="Purity" Header="Purity (%)">
                <dxg:GridColumn.EditSettings>
                    <dxe:SpinEditSettings MinValue="0" MaxValue="100" Increment="0.1"/>
                </dxg:GridColumn.EditSettings>
            </dxg:GridColumn>

            <dxg:GridColumn FieldName="Weight" Header="Weight (g)">
                <dxg:GridColumn.EditSettings>
                    <dxe:SpinEditSettings MinValue="0" MaxValue="10000" Increment="0.01"/>
                </dxg:GridColumn.EditSettings>
            </dxg:GridColumn>

            <dxg:GridColumn FieldName="RatePerGram" Header="Rate/Gram">
                <dxg:GridColumn.EditSettings>
                    <dxe:SpinEditSettings MinValue="0" MaxValue="100000" Increment="1"/>
                </dxg:GridColumn.EditSettings>
            </dxg:GridColumn>

            <dxg:GridColumn FieldName="TotalValue" Header="Total Value"
                            UnboundType="Decimal"
                            UnboundExpression="[Weight] * [RatePerGram]"
                            ReadOnly="True"/>
        </dxg:GridControl>

        <!-- Summary & Actions -->
        <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
            <TextBlock Text="Total Value:" FontWeight="Bold" Margin="0,0,10,0"/>
            <TextBlock Text="{Binding TotalValue}" Foreground="DarkBlue" Margin="0,0,20,0"/>
            <Button Content="Add Item" Width="100" Margin="5" Command="{Binding AddItemCommand}"/>
            <Button Content="Save" Width="100" Margin="5" Command="{Binding SaveCommand}"/>
            <Button Content="Reset" Width="100" Margin="5" Command="{Binding ResetCommand}"/>
            <Button Content="Close" Width="100" Margin="5" Command="{Binding CloseCommand}"/>
        </StackPanel>
    </Grid>
</UserControl>